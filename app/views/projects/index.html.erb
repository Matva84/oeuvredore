<div>
  <div class="row">
    <div class="col-2">
      <%= render "shared/navmenu" %>
    </div>

    <div class="col-10">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <div class="card text-center">
              <div class="card-body custom-card-body">
                <h5 class="card-title mt-2">Projets réalisés</h5>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card text-center">
              <div class="card-body custom-card-body">
                <h5 class="card-title mt-2">Projets en cours: <%= @total_projects %> </h5>
              </div>
            </div>
          </div>
        </div>

        <div class="container">
          <div class="row mt-6">
            <div class="col-md-9">
              <h2 class="h2-black">Mes projets</h1>
            </div>
            <div class="col-md-3 text-right mt-5">
            <!-- button Modal -->
              <% if @user.pro %>
                <button type="button" class="main-btn" data-bs-toggle="modal" data-bs-target="#newProjectModal">
                  Ajouter Nouveau Projet
                </button>
              <% end %>
            <!-- Modal -->
              <div class="modal fade" id="newProjectModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content">
                     <div class="modal-header">
                        <h5 class="modal-title" id="newProjectModal">Ajouter Nouveau Projet</h5>
                        <button type="button" class="main-btn" data-bs-dismiss="modal" aria-label="Close"></button>
                     </div>
                       <div class="modal-body">
                        <%= render "newproject", project: @new_project_path %>
                       </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <% @projects.each do |project| %>
            <div class="col-md-4 mb-4">
              <div class="card">
                <div class="card-body fixed-height">
                  <div class="container">
                    <div class="img-container">
                      <%= cl_image_tag project.photo.key, crop: :fill, class: "img-thumbnail" %>
                    </div>
                  </div>
                  <div class= "card-content">
                    <h5 class="card-title"><%= project.title %></h5>
                    <div class="text-maxheight">
                      <p class="card-text"><%= project.description %></p>
                    </div>
                <!-- Barre de progression du planning -->
                    <p><strong>Progression</strong></p>
                    <div class="w3-darkgreen w3-round-large">
                      <% s = "width:#{project.progress}%" %>
                      <div class="w3-container w3-green w3-round-large" style="<%= s %>">
                        <% if project.progress.round < 10 %>
                          <p class="greentext"></p>
                        <% else %>
                          <%= project.progress.round %>%
                        <% end %>
                      </div>
                    </div>
                    <%= link_to "Voir le projet", project_path(project), class: "main-btn-rounded", id: "btn-margin" %>
                  </div>
                </div>
                </div>
            </div>
            <% end %>
          </div>

          <div class="container">
            <div class="row mt-6">
              <div class="col-md-2 text-md-right mt-5">
                <% if @show_all_projects %>
                  <%= link_to "Réduire", projects_path, class: "btn btn-see mt-3 mb-5" %>
                <% else %>
                  <%= link_to "Tout voir", projects_path(show_all: true), class: " btn btn-see mt-3 mb-5" %>
                <% end %>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
